<!-- daily_inquiry.ejs | Never edit this line-->
 
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Daily Output Inquiry | NexERP</title>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/jquery.datepick.css">
  <link rel="stylesheet" href="/css/mrp.css">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/jquery.plugin.min.js"></script>
  <script src="/js/jquery.datepick.min.js"></script>
  <script src="/js/mrp.js"></script>
  <style>
    body, h1, h2, h3, h4, h5, h6, p, label, input, select, button {
      font-family: 'Poppins', sans-serif;
    }
    
    body {
      background-color: #f8f9fa;
    }
    
    .page-header {
      margin-bottom: 2rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .form-card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      margin-bottom: 24px;
      padding: 24px;
      transition: all 0.3s ease;
    }
    
    .form-card:hover {
      box-shadow: 0 8px 15px rgba(0,0,0,0.1);
    }
    
    .dashboard-card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      margin-bottom: 24px;
      transition: all 0.3s ease;
      height: 100%;
      overflow: hidden;
    }
    
    .dashboard-card:hover {
      box-shadow: 0 8px 15px rgba(0,0,0,0.1);
      transform: translateY(-3px);
    }
    
    .nav-bar {
      background-color: rgb(0,0,255);
      color: white;
      box-shadow: 0 2px 10px rgba(0,0,255,0.3);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .nav-bar a {
      padding: 16px;
      font-weight: 500;
      letter-spacing: 0.3px;
      transition: background-color 0.3s;
    }
    
    .nav-bar a:hover {
      background-color: rgba(255,255,255,0.1);
    }
    
    .btn {
      border-radius: 4px;
      font-weight: 500;
      padding: 8px 16px;
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .btn-primary {
      background-color: rgb(0,0,255);
      color: white;
      border: none;
    }
    
    .btn-primary:hover {
      background-color: rgba(0,0,255,0.9);
      box-shadow: 0 4px 8px rgba(0,0,255,0.2);
    }
    
    .btn-secondary {
      background-color: #f5f5f5;
      color: #333;
      border: 1px solid #ddd;
    }
    
    .btn-secondary:hover {
      background-color: #eee;
    }
    
    .page-title {
      font-weight: 600;
      color: #333;
      margin: 24px 0;
      padding-bottom: 8px;
      border-bottom: 2px solid rgb(0,0,255);
      display: inline-block;
    }
    
    .form-control {
      border-radius: 4px;
      border: 1px solid #e0e0e0;
      padding: 8px 12px;
      transition: all 0.3s ease;
    }
    
    .form-control:focus {
      border-color: rgb(0,0,255);
      box-shadow: 0 0 0 3px rgba(0,0,255,0.1);
    }
    
    .table-container {
      overflow-x: auto;
      border-radius: 6px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    /* Animation for cards */
    .animate-fade-in {
      animation: fadeIn 0.6s ease-in-out forwards;
      opacity: 0;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .delay-1 { animation-delay: 0.1s; }
    .delay-2 { animation-delay: 0.2s; }
    .delay-3 { animation-delay: 0.3s; }
    
    /* Dashboard cards with different blue shades */
    .blue-card {
      background-color: #0000FF; /* True Royal Blue to match image 1 */
      color: white;
      padding: 20px;
      text-align: center;
      border-radius: 8px;
    }
    
    .card-number {
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .card-label {
      font-size: 16px;
      font-weight: 500;
    }
    
    /* Table styling to match the image */
    .data-table {
      width: 100%;
      white-space: nowrap;
    }
    
    .data-table th {
      background-color: #f5f5f5;
      font-weight: 600;
      padding: 10px;
      text-align: center;
      border: 1px solid #ddd;
    }
    
    .data-table td {
      padding: 8px 10px;
      border: 1px solid #ddd;
      text-align: center;
    }
    
    .data-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    .data-table tr:hover {
      background-color: #f0f0f0;
    }
    
    /* Making the table fixed layout and with horizontal scrolling */
    .table-responsive {
      overflow-x: auto;
      margin-bottom: 20px;
    }
    
    /* Button styles */
    .btn-icon {
      padding: 4px 8px;
      margin: 0 3px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-icon.edit {
      background-color: #4CAF50;
      color: white;
    }
    
    .btn-icon.view {
      background-color: #2196F3;
      color: white;
    }
    
    .btn-icon.delete {
      background-color: #f44336;
      color: white;
    }
    
    .overtime-tag {
      display: inline-block;
      padding: 2px 6px;
      background-color: #FF9800;
      color: white;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
    }
    
    /* Search form styling */
    .search-form {
      background-color: white;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .search-form .w3-row {
      margin-bottom: 10px;
    }
    
    .search-form input, .search-form select {
      height: 38px;
    }
    
    .search-form .btn {
      height: 38px;
    }
  </style>
</head>
<body>

<div class="w3-bar nav-bar">
  <a href="/page/dashboard" class="w3-bar-item w3-button w3-mobile"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
  <a href="/page/daily-output/new" class="w3-bar-item w3-button w3-mobile"><i class="fas fa-plus-circle"></i> New Daily Output</a>
  <a href="/page/daily-output/list" class="w3-bar-item w3-button w3-mobile"><i class="fas fa-list"></i> Daily Output List</a>
  <a href="/page/daily-output/inquiry" class="w3-bar-item w3-button w3-mobile w3-blue"><i class="fas fa-search"></i> Daily Output Inquiry</a>
  <a href="/page/help" class="w3-bar-item w3-button w3-mobile"><i class="fas fa-question-circle"></i> Help</a>
</div>

<div id="myContent" class="w3-main" style="min-height: calc(100vh - 120px); padding: 24px;">
  <!-- Header -->
  <h2 class="page-title"><i class="fas fa-search"></i> Daily Output Inquiry</h2>

  <!-- Dashboard Cards -->
  <div class="w3-row-padding">
    <div class="w3-col l3 m6 s12 animate-fade-in delay-1">
      <div class="blue-card">
        <div class="card-number"><%= locals.dashboardCounts ? dashboardCounts.todaysOutput : 0 %></div>
        <div class="card-label">Today's Daily Output</div>
      </div>
    </div>
    <div class="w3-col l3 m6 s12 animate-fade-in delay-1">
      <div class="blue-card">
        <div class="card-number"><%= locals.dashboardCounts ? dashboardCounts.pendingApprovals : 0 %></div>
        <div class="card-label">Pending Approvals</div>
      </div>
    </div>
    <div class="w3-col l3 m6 s12 animate-fade-in delay-2">
      <div class="blue-card">
        <div class="card-number"><%= locals.dashboardCounts ? dashboardCounts.activeWorkOrders : 0 %></div>
        <div class="card-label">Active Work Orders</div>
      </div>
    </div>
    <div class="w3-col l3 m6 s12 animate-fade-in delay-2">
      <div class="blue-card">
        <div class="card-number"><%= locals.dashboardCounts ? dashboardCounts.completedThisMonth : 0 %></div>
        <div class="card-label">Completed This Month</div>
      </div>
    </div>
  </div>

  <!-- Search Form -->
  <div class="search-form animate-fade-in delay-1">
    <form action="" method="GET">
      <div class="w3-row-padding">
        <div class="w3-col l3 m6 s12">
          <label>From Date</label>
          <input class="w3-input w3-border form-control datepicker" type="text" name="from_date" value="<%= locals.filters && filters.from_date || '' %>">
        </div>
        <div class="w3-col l3 m6 s12">
          <label>To Date</label>
          <input class="w3-input w3-border form-control datepicker" type="text" name="to_date" value="<%= locals.filters && filters.to_date || '' %>">
        </div>
        <div class="w3-col l3 m6 s12">
          <label>Reference</label>
          <input class="w3-input w3-border form-control" type="text" name="reference" value="<%= locals.filters && filters.reference || '' %>">
        </div>
        <div class="w3-col l3 m6 s12">
          <label>Job Order</label>
          <input class="w3-input w3-border form-control" type="text" name="job_order" value="<%= locals.filters && filters.job_order || '' %>">
        </div>
      </div>
      <div class="w3-row-padding w3-margin-top">
        <div class="w3-col s12">
          <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i> Search</button>
          <button type="button" class="btn btn-secondary" onClick="clearFilters()">Clear</button>
        </div>
      </div>
    </form>
  </div>

  <!-- Table Display -->
  <div class="table-responsive animate-fade-in delay-2">
    <% if (locals.data) { %>
      <!-- Debug info: <%= data.length %> records found -->
    <% } %>
    <table class="data-table w3-table w3-bordered w3-striped">
      <thead>
        <tr>
          <th>#</th>
          <th>TXN ID</th>
          <th>DOC DATE</th>
          <th>START TIME</th>
          <th>END TIME</th>
          <th>DAILY NO</th>
          <th>JO NO</th>
          <th>PROCESS DESCRIPTION</th>
          <th>MASTER CODE</th>
          <th>OUTPUT ITEM</th>
          <th>OUTPUT QTY</th>
          <th>REJECT QTY</th>
          <th>LEAD TIME</th>
          <th>MAN COUNT</th>
          <th>MACHINE</th>
          <th>OPERATOR</th>
          <th>REMARK</th>
          <th>CREATE DATE</th>
          <th>ISSUED BY</th>
        </tr>
      </thead>
      <tbody>
        <% if (locals.data && data.length > 0) { %>
          <% data.forEach(function(item, index) { %>
            <tr>
              <td><%= index + 1 %></td>
              <td><%= item.txn_id %></td>
              <td><%= item.doc_date %></td>
              <td><%= item.start_time %></td>
              <td><%= item.end_time %></td>
              <td><%= item.daily_no %></td>
              <td><%= item.jo_no %></td>
              <td><%= item.process_description || 'N/A' %></td>
              <td><%= item.master_code || 'N/A' %></td>
              <td><%= item.output_item || 'N/A' %></td>
              <td><%= item.output_qty || '0' %></td>
              <td><%= item.reject_qty || '0' %></td>
              <td><%= item.lead_time || 'N/A' %></td>
              <td><%= item.man_count || '1' %></td>
              <td><%= item.machine || 'N/A' %></td>
              <td><%= item.operator || 'N/A' %></td>
              <td><%= item.remark || '' %></td>
              <td><%= item.create_date || 'N/A' %></td>
              <td><%= item.issued_by || 'N/A' %></td>
            </tr>
          <% }); %>
        <% } else { %>
          <tr>
            <td colspan="19" class="w3-center">No records found</td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <% if (locals.pagination) { %>
    <div class="w3-container w3-center w3-margin-top animate-fade-in delay-2">
      <div class="w3-bar">
        <% if (pagination.currentPage > 1) { %>
          <a href="?page=1<%= pagination.queryParams %>" class="btn btn-secondary" style="margin-right: 5px;">&laquo; First</a>
          <a href="?page=<%= pagination.currentPage - 1 %><%= pagination.queryParams %>" class="btn btn-secondary" style="margin-right: 5px;">&laquo; Previous</a>
        <% } %>
        
        <% for(let i = pagination.startPage; i <= pagination.endPage; i++) { %>
          <% if (i === pagination.currentPage) { %>
            <a href="?page=<%= i %><%= pagination.queryParams %>" class="btn btn-primary" style="margin-right: 5px;"><%= i %></a>
          <% } else { %>
            <a href="?page=<%= i %><%= pagination.queryParams %>" class="btn btn-secondary" style="margin-right: 5px;"><%= i %></a>
          <% } %>
        <% } %>
        
        <% if (pagination.currentPage < pagination.totalPages) { %>
          <a href="?page=<%= pagination.currentPage + 1 %><%= pagination.queryParams %>" class="btn btn-secondary" style="margin-right: 5px;">Next &raquo;</a>
          <a href="?page=<%= pagination.totalPages %><%= pagination.queryParams %>" class="btn btn-secondary">Last &raquo;</a>
        <% } %>
      </div>
      <div class="w3-margin-top">
        Showing <%= pagination.startRecord %> to <%= pagination.endRecord %> of <%= pagination.totalRecords %> records
      </div>
    </div>
  <% } %>

  <!-- Sample data for demo purposes -->
  <div class="w3-container w3-margin-top">
    <a href="/page/daily-output/new" class="btn btn-primary"><i class="fas fa-plus"></i> New Daily Output</a>
    <a href="/page/daily-output/inquiry/sample" class="btn btn-primary"><i class="fas fa-table"></i> Load Sample Data</a>
    <a href="/page/dashboard" class="btn btn-secondary"><i class="fas fa-home"></i> Dashboard</a>
  </div>
</div>

<script>
  $(document).ready(function() {
    // Initialize datepicker
    $('.datepicker').datepick({
      dateFormat: 'dd-mm-yyyy',
      showOnFocus: true,
      showTrigger: '<button type="button" class="w3-button w3-blue"><i class="fa fa-calendar"></i></button>'
    });
  });
  
  function clearFilters() {
    $('input[name="from_date"]').val('');
    $('input[name="to_date"]').val('');
    $('input[name="reference"]').val('');
    $('input[name="job_order"]').val('');
    window.location.href = window.location.pathname;
  }
</script>

</body>
</html>